<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用手册 | mpvue.com</title>
    <meta name="description" content="mpvue document">
    <link rel="icon" href="/techthink/">
    
    <link rel="preload" href="/techthink/assets/css/0.styles.430d4046.css" as="style"><link rel="preload" href="/techthink/assets/js/app.7b5c53e5.js" as="script"><link rel="preload" href="/techthink/assets/js/2.7e3077ca.js" as="script"><link rel="preload" href="/techthink/assets/js/8.aad0e4ab.js" as="script"><link rel="prefetch" href="/techthink/assets/js/10.a45aee8c.js"><link rel="prefetch" href="/techthink/assets/js/11.46b2c560.js"><link rel="prefetch" href="/techthink/assets/js/12.651b4ca0.js"><link rel="prefetch" href="/techthink/assets/js/13.2210049b.js"><link rel="prefetch" href="/techthink/assets/js/14.260c888d.js"><link rel="prefetch" href="/techthink/assets/js/15.5736afd6.js"><link rel="prefetch" href="/techthink/assets/js/16.9d9845d3.js"><link rel="prefetch" href="/techthink/assets/js/17.7a1d5864.js"><link rel="prefetch" href="/techthink/assets/js/18.4960df51.js"><link rel="prefetch" href="/techthink/assets/js/19.42906405.js"><link rel="prefetch" href="/techthink/assets/js/20.834fbdab.js"><link rel="prefetch" href="/techthink/assets/js/3.21c82aae.js"><link rel="prefetch" href="/techthink/assets/js/4.ea251d3c.js"><link rel="prefetch" href="/techthink/assets/js/5.084a8e6f.js"><link rel="prefetch" href="/techthink/assets/js/6.26a104c3.js"><link rel="prefetch" href="/techthink/assets/js/7.253f6987.js"><link rel="prefetch" href="/techthink/assets/js/9.78c281e5.js">
    <link rel="stylesheet" href="/techthink/assets/css/0.styles.430d4046.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/techthink/" class="home-link router-link-active"><!----> <span class="site-name">mpvue.com</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/techthink/" class="nav-link">首页</a></div><div class="nav-item"><a href="/techthink/qa.html" class="nav-link">Q&amp;A</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">build</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/build/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/mpvue-webpack-target.html" class="nav-link">mpvue-webpack-target</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/postcss-mpvue-wxss.html" class="nav-link">postcss-mpvue-wxss</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/px2rpx-loader.html" class="nav-link">px2rpx-loader</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/mpvue-lint.html" class="nav-link">mpvue-lint</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/webpack-mpvue-asset-plugin.html" class="nav-link">webpack-mpvue-asset-plugin</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">mpvue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/mpvue/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/mpvue-template-compiler.html" class="nav-link">mpvue-template-compiler</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/quickstart.html" class="nav-link">quickstart</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/simple.html" class="nav-link">Simple</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">changelog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/change-log/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/change-log/2018.7.24.html" class="nav-link">2018.7.24</a></li></ul></div></div> <a href="https://github.com/hucq/techthink" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/techthink/" class="nav-link">首页</a></div><div class="nav-item"><a href="/techthink/qa.html" class="nav-link">Q&amp;A</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">build</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/build/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/mpvue-webpack-target.html" class="nav-link">mpvue-webpack-target</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/postcss-mpvue-wxss.html" class="nav-link">postcss-mpvue-wxss</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/px2rpx-loader.html" class="nav-link">px2rpx-loader</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/mpvue-lint.html" class="nav-link">mpvue-lint</a></li><li class="dropdown-item"><!----> <a href="/techthink/build/webpack-mpvue-asset-plugin.html" class="nav-link">webpack-mpvue-asset-plugin</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">mpvue</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/mpvue/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/mpvue-template-compiler.html" class="nav-link">mpvue-template-compiler</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/quickstart.html" class="nav-link">quickstart</a></li><li class="dropdown-item"><!----> <a href="/techthink/mpvue/simple.html" class="nav-link">Simple</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">changelog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/techthink/change-log/index.html" class="nav-link">index</a></li><li class="dropdown-item"><!----> <a href="/techthink/change-log/2018.7.24.html" class="nav-link">2018.7.24</a></li></ul></div></div> <a href="https://github.com/hucq/techthink" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="使用手册"><a href="#使用手册" aria-hidden="true" class="header-anchor">#</a> 使用手册</h1> <p><code>mpvue</code> 继承自 <code>Vue.js</code>，其技术规范和语法特点与 <code>Vue.js</code> 保持一致。</p> <p>本文档适用于有一定 <code>Vue.js</code> 使用经验的开发者。我们默认你已经掌握 <code>Vue.js</code> 技术体系，<strong>如果你是新手</strong>，你可能需要先熟悉 <a href="https://cn.vuejs.org/guide/" target="_blank" rel="noopener noreferrer">Vue.js 官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="五分钟教程"><a href="#五分钟教程" aria-hidden="true" class="header-anchor">#</a> 五分钟教程</h2> <p>通过 <code>Vue.js</code> 命令行工具 <a href="https://github.com/vuejs/vue-cli" target="_blank" rel="noopener noreferrer">vue-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，你只需在终端窗口输入几条简单命令，即可快速创建和启动一个带热重载、保存时静态检查、内置代码构建功能的小程序项目：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 全局安装 vue-cli</span>
$ <span class="token function">npm</span> <span class="token function">install</span> --global vue-cli

<span class="token comment"># 创建一个基于 mpvue-quickstart 模板的新项目</span>
$ vue init mpvue/mpvue-quickstart my-project

<span class="token comment"># 安装依赖</span>
$ <span class="token builtin class-name">cd</span> my-project
$ <span class="token function">npm</span> <span class="token function">install</span>
<span class="token comment"># 启动构建</span>
$ <span class="token function">npm</span> run dev
</code></pre></div><p>接下来，你只需要启动<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/quickstart/basic/getting-started.html#%E5%AE%89%E8%A3%85%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7" target="_blank" rel="noopener noreferrer">微信开发者工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，引入项目即可预览到你的第一个 <code>mpvue</code> 小程序。</p> <h2 id="框架原理"><a href="#框架原理" aria-hidden="true" class="header-anchor">#</a> 框架原理</h2> <ul><li><code>mpvue</code> 保留了 vue.runtime 核心方法，无缝继承了 <code>Vue.js</code> 的基础能力</li> <li><code>mpvue-template-compiler</code> 提供了将 vue 的模板语法转换到小程序的 wxml 语法的能力</li> <li>修改了 vue 的建构配置，使之构建出符合小程序项目结构的代码格式： json/wxml/wxss/js 文件</li></ul> <h2 id="vue-实例"><a href="#vue-实例" aria-hidden="true" class="header-anchor">#</a> Vue 实例</h2> <p>支持 <a href="https://cn.vuejs.org/v2/guide/instance.html" target="_blank" rel="noopener noreferrer">官方文档：Vue 实例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，同时我们做了一些修改，来适应小程序的独特加载逻辑。</p> <h3 id="实例生命周期"><a href="#实例生命周期" aria-hidden="true" class="header-anchor">#</a> 实例生命周期</h3> <p>同 vue，不同的是我们会在小程序 onReady 后，再去触发 vue mounted 生命周期，详细的 vue 生命周期文档请看<a href="https://cn.vuejs.org/v2/api/#%E9%80%89%E9%A1%B9-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90" target="_blank" rel="noopener noreferrer">生命周期钩子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>beforeCreate</li> <li>created</li> <li>beforeMount</li> <li>mounted</li> <li>beforeUpdate</li> <li>updated</li> <li>activated</li> <li>deactivated</li> <li>beforeDestroy</li> <li>destroyed</li></ul> <p>除了 Vue 本身的生命周期外，mpvue 还兼容了小程序生命周期，这部分生命周期钩子的来源于<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/page.html" target="_blank" rel="noopener noreferrer">微信小程序的 Page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>， 除特殊情况外，不建议使用小程序的生命周期钩子。</p> <p><strong>app 部分：</strong></p> <ul><li>onLaunch，初始化</li> <li>onShow，当小程序启动，或从后台进入前台显示</li> <li>onHide，当小程序从前台进入后台</li></ul> <p><strong>page 部分：</strong></p> <ul><li>onLoad，监听页面加载</li> <li>onShow，监听页面显示</li> <li>onReady，监听页面初次渲染完成</li> <li>onHide，监听页面隐藏</li> <li>onUnload，监听页面卸载</li> <li>onPullDownRefresh，监听用户下拉动作</li> <li>onReachBottom，页面上拉触底事件的处理函数</li> <li>onShareAppMessage，用户点击右上角分享</li> <li>onPageScroll，页面滚动</li> <li>onTabItemTap, 当前是 tab 页时，点击 tab 时触发 （mpvue 0.0.16 支持）</li></ul> <p>用法示例：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// `this` 指向 vm 实例</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a is: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// `this` 指向 vm 实例</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a is: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token string">'小程序触发的 onshow'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// =&gt; &quot;a is: 1&quot;</span>
</code></pre></div><p><strong>注意点：</strong></p> <ol><li><p>不要在选项属性或回调上使用箭头函数，比如 <code>created: () =&gt; console.log(this.a)</code> 或 <code>vm.$watch('a', newValue =&gt; this.myMethod())</code>。因为箭头函数是和父级上下文绑定在一起的，<code>this</code> 不会是如你做预期的 Vue 实例，且 <code>this.a</code> 或 <code>this.myMethod</code> 也会是未定义的。</p></li> <li><p>微信小程序的页面的 <code>query</code> 参数是通过 <code>onLoad</code> 获取的，mpvue 对此进行了优化，直接通过 <code>this.$root.$mp.query</code> 获取相应的参数数据，其调用需要在 <code>onLoad</code> 生命周期触发之后使用，比如 <code>onShow</code> 等，具体生命周期调用顺序，见下图。</p></li></ol> <h3 id="生命周期图示"><a href="#生命周期图示" aria-hidden="true" class="header-anchor">#</a> 生命周期图示</h3> <blockquote><p>你不需要立马弄明白所有的东西，不过随着你的不断学习和使用，它的参考价值会越来越高。</p></blockquote> <p>生命周期的调用关系和顺序图。</p> <p><img src="/techthink/assets/img/lifecycle.a8762770.jpg" alt=""></p> <h2 id="模板语法"><a href="#模板语法" aria-hidden="true" class="header-anchor">#</a> 模板语法</h2> <p>几乎全支持 <a href="https://cn.vuejs.org/v2/guide/syntax.html" target="_blank" rel="noopener noreferrer">官方文档：模板语法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，下面讲下不支持的情况。</p> <h3 id="不支持-纯-html"><a href="#不支持-纯-html" aria-hidden="true" class="header-anchor">#</a> 不支持 <code>纯-HTML</code></h3> <p>小程序里所有的 BOM／DOM 都不能用，也就是说 <code>v-html</code> 指令不能用。</p> <h3 id="不支持部分复杂的-javascript-渲染表达式"><a href="#不支持部分复杂的-javascript-渲染表达式" aria-hidden="true" class="header-anchor">#</a> 不支持部分复杂的 JavaScript 渲染表达式</h3> <p>我们会把 template 中的 <code>{{}}</code> 双花括号的部分，直接编码到 wxml 文件中，由于微信小程序的能力限制(<a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/data.html" target="_blank" rel="noopener noreferrer">数据绑定<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)，所以无法支持复杂的 JavaScript 表达式。</p> <p>目前可以使用的有 <code>+ - * % ?: ! == === &gt; &lt; [] .</code>，剩下的还待完善。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 这种就不支持，建议写 computed --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ message.split('').reverse().join('') }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 但写在 @event 里面的表达式是都支持的，因为这部分的计算放在了 vdom 里面 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item in list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>clickHandle(item, index, $event)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.value }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="不支持过滤器"><a href="#不支持过滤器" aria-hidden="true" class="header-anchor">#</a> 不支持过滤器</h3> <p>渲染部分会转成 wxml ，wxml 不支持过滤器，所以这部分功能不支持。</p> <h2 id="计算属性"><a href="#计算属性" aria-hidden="true" class="header-anchor">#</a> 计算属性</h2> <p>支持 <a href="https://cn.vuejs.org/v2/guide/computed.html" target="_blank" rel="noopener noreferrer">官方文档：计算属性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="不支持函数"><a href="#不支持函数" aria-hidden="true" class="header-anchor">#</a> 不支持函数</h2> <p>不支持在 template 内使用 methods 中的函数。</p> <h2 id="class-与-style-绑定"><a href="#class-与-style-绑定" aria-hidden="true" class="header-anchor">#</a> Class 与 Style 绑定</h2> <p>为节约性能，我们将 Class 与 Style 的表达式通过 compiler 硬编码到 wxml 中，支持语法和转换效果如下：</p> <p>class 支持的语法:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;p :class=&quot;{ active: isActive }&quot;&gt;111&lt;/p&gt;
&lt;p class=&quot;static&quot; v-bind:class=&quot;{ active: isActive, 'text-danger': hasError }&quot;&gt;222&lt;/p&gt;
&lt;p class=&quot;static&quot; :class=&quot;[activeClass, errorClass]&quot;&gt;333&lt;/p&gt;
&lt;p class=&quot;static&quot; v-bind:class=&quot;[isActive ? activeClass : '', errorClass]&quot;&gt;444&lt;/p&gt;
&lt;p class=&quot;static&quot; v-bind:class=&quot;[{ active: isActive }, errorClass]&quot;&gt;555&lt;/p&gt;
</code></pre></div><p>将分别被转换成:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;view class=&quot;_p {{[isActive ? 'active' : '']}}&quot;&gt;111&lt;/view&gt;
&lt;view class=&quot;_p static {{[isActive ? 'active' : '', hasError ? 'text-danger' : '']}}&quot;&gt;222&lt;/view&gt;
&lt;view class=&quot;_p static {{[activeClass, errorClass]}}&quot;&gt;333&lt;/view&gt;
&lt;view class=&quot;_p static {{[isActive ? activeClass : '', errorClass]}}&quot;&gt;444&lt;/view&gt;
&lt;view class=&quot;_p static {{[[isActive ? 'active' : ''], errorClass]}}&quot;&gt;555&lt;/view&gt;
</code></pre></div><p>style 支持的语法:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;p v-bind:style=&quot;{ color: activeColor, fontSize: fontSize + 'px' }&quot;&gt;666&lt;/p&gt;
&lt;p v-bind:style=&quot;[{ color: activeColor, fontSize: fontSize + 'px' }]&quot;&gt;777&lt;/p&gt;
</code></pre></div><p>将分别被转换成:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;view class=&quot;_p&quot; style=&quot; {{'color:' + activeColor + ';' + 'font-size:' + fontSize + 'px' + ';'}}&quot;&gt;666&lt;/view&gt;
&lt;view class=&quot;_p&quot; style=&quot; {{'color:' + activeColor + ';' + 'font-size:' + fontSize + 'px' + ';'}}&quot;&gt;777&lt;/view&gt;
</code></pre></div><p>不支持 <a href="https://cn.vuejs.org/v2/guide/class-and-style.html" target="_blank" rel="noopener noreferrer">官方文档：Class 与 Style 绑定<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中的 <code>classObject</code> 和 <code>styleObject</code> 语法。</p> <p>最佳实践见上文支持的语法，<strong>从性能考虑，建议不要过度依赖此。</strong></p> <p>此外还可以用 computed 方法生成 class 或者 style 字符串，插入到页面中，举例说明：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 支持 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>computedClassStr<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{active: isActive}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 不支持 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>computedClassObject<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
        <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                isActive<span class="token punctuation">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token function">computedClassStr</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isActive <span class="token operator">?</span> <span class="token string">'active'</span> <span class="token punctuation">:</span> <span class="token string">''</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">computedClassObject</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span> active<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isActive <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="用在组件上"><a href="#用在组件上" aria-hidden="true" class="header-anchor">#</a> 用在组件上</h3> <p>暂不支持在组件上使用 Class 与 Style 绑定</p> <h2 id="条件渲染"><a href="#条件渲染" aria-hidden="true" class="header-anchor">#</a> 条件渲染</h2> <p>全支持 <a href="https://cn.vuejs.org/v2/guide/conditional.html" target="_blank" rel="noopener noreferrer">官方文档：条件渲染<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="列表渲染"><a href="#列表渲染" aria-hidden="true" class="header-anchor">#</a> 列表渲染</h2> <p>全支持 <a href="https://cn.vuejs.org/v2/guide/list.html" target="_blank" rel="noopener noreferrer">官方文档：列表渲染<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>只是需要注意一点，<strong>嵌套列表渲染，必须指定不同的索引！</strong></p> <p>示例：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 在这种嵌套循环的时候， index 和 itemIndex 这种索引是必须指定，且别名不能相同，正确的写法如下 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(card, index) in list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item, itemIndex) in card<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            {{item.value}}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="事件处理器"><a href="#事件处理器" aria-hidden="true" class="header-anchor">#</a> 事件处理器</h2> <p>几乎全支持啦 <a href="https://cn.vuejs.org/v2/guide/events.html" target="_blank" rel="noopener noreferrer">官方文档：事件处理器<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>我们引入了 Vue.js 的虚拟 DOM ，在前文模版中绑定的事件会被挂在到 vnode 上，同时我们的 compiler 在 wxml 上绑定了小程序的事件，并做了相应的映射，所以你在真实点击的时候通过 runtime 中 <code>handleProxy</code> 通过事件类型分发到 vnode 的事件上，同 Vue 在 WEB 的机制一样，所以可以做到无损支持。同时还顺便支持了自定义事件和 <code>$emit</code> 机制。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 事件映射表，左侧为 WEB 事件，右侧为 小程序 对应事件</span>
<span class="token punctuation">{</span>
    click<span class="token punctuation">:</span> <span class="token string">'tap'</span><span class="token punctuation">,</span>
    touchstart<span class="token punctuation">:</span> <span class="token string">'touchstart'</span><span class="token punctuation">,</span>
    touchmove<span class="token punctuation">:</span> <span class="token string">'touchmove'</span><span class="token punctuation">,</span>
    touchcancel<span class="token punctuation">:</span> <span class="token string">'touchcancel'</span><span class="token punctuation">,</span>
    touchend<span class="token punctuation">:</span> <span class="token string">'touchend'</span><span class="token punctuation">,</span>
    tap<span class="token punctuation">:</span> <span class="token string">'tap'</span><span class="token punctuation">,</span>
    longtap<span class="token punctuation">:</span> <span class="token string">'longtap'</span><span class="token punctuation">,</span>
    input<span class="token punctuation">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
    change<span class="token punctuation">:</span> <span class="token string">'change'</span><span class="token punctuation">,</span>
    submit<span class="token punctuation">:</span> <span class="token string">'submit'</span><span class="token punctuation">,</span>
    blur<span class="token punctuation">:</span> <span class="token string">'blur'</span><span class="token punctuation">,</span>
    focus<span class="token punctuation">:</span> <span class="token string">'focus'</span><span class="token punctuation">,</span>
    reset<span class="token punctuation">:</span> <span class="token string">'reset'</span><span class="token punctuation">,</span>
    confirm<span class="token punctuation">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
    columnchange<span class="token punctuation">:</span> <span class="token string">'columnchange'</span><span class="token punctuation">,</span>
    linechange<span class="token punctuation">:</span> <span class="token string">'linechange'</span><span class="token punctuation">,</span>
    error<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
    scrolltoupper<span class="token punctuation">:</span> <span class="token string">'scrolltoupper'</span><span class="token punctuation">,</span>
    scrolltolower<span class="token punctuation">:</span> <span class="token string">'scrolltolower'</span><span class="token punctuation">,</span>
    scroll<span class="token punctuation">:</span> <span class="token string">'scroll'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在 <code>input</code> 和 <code>textarea</code> 中 <code>change</code> 事件会被转为 <code>blur</code> 事件。</p> <p><strong>踩坑注意：</strong></p> <ul><li>列表中没有的原生事件也可以使用例如 bindregionchange 事件直接在 dom 上将bind改为@ <code>@regionchange</code>,同时这个事件也非常特殊，它的 event type 有 begin 和 end 两个，导致我们无法在<code>handleProxy</code> 中区分到底是什么事件，所以你在监听此类事件的时候同时监听事件名和事件类型既 <code>&lt;map @regionchange=&quot;functionName&quot; @end=&quot;functionName&quot; @begin=&quot;functionName&quot;&gt;&lt;map&gt;</code></li> <li>小程序能力所致，bind 和 catch 事件同时绑定时候，只会触发 bind ,catch 不会被触发，要避免踩坑。</li> <li>事件修饰符
<ul><li><code>.stop</code> 的使用会阻止冒泡，但是同时绑定了一个非冒泡事件，会导致该元素上的 catchEventName 失效！</li> <li><code>.prevent</code> 可以直接干掉，因为小程序里没有什么默认事件，比如submit并不会跳转页面</li> <li><code>.capture</code> 支持 <code>1.0.9</code></li> <li><code>.self</code> 没有可以判断的标识</li> <li><code>.once</code> 也不能做，因为小程序没有 removeEventListener, 虽然可以直接在 handleProxy 中处理，但非常的不优雅，违背了原意，暂不考虑</li></ul></li> <li>其他 键值修饰符 等在小程序中压根没键盘，所以。。。</li></ul> <h2 id="表单控件绑定"><a href="#表单控件绑定" aria-hidden="true" class="header-anchor">#</a> 表单控件绑定</h2> <p>几乎全支持 <a href="https://cn.vuejs.org/v2/guide/forms.html" target="_blank" rel="noopener noreferrer">官方文档：表单控件绑定<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，不支持的还没测出来，之所以说几乎，是因为 WEB 表单这么复杂，谁特么知道会出什么奇怪的特性。</p> <p>建议开发过程中直接使用 <a href="https://mp.weixin.qq.com/debug/wxadoc/dev/component/button.html" target="_blank" rel="noopener noreferrer">微信小程序：表单组件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。用法示例：</p> <p><a href="https://github.com/Meituan-Dianping/mpvue/issues/58" target="_blank" rel="noopener noreferrer">select 组件用 picker 组件进行代替<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picker</span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bindPickerChange<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:range</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>array<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>picker<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        当前选择：{{array[index]}}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picker</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      index<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">bindPickerChange</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><a href="https://github.com/Meituan-Dianping/mpvue/issues/66" target="_blank" rel="noopener noreferrer">表单元素 radio 用 radio-group 组件进行代替<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio-group</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>radio-group<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>radioChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(item, index) in items<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:checked</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item.checked<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> {{item.value}}
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio-group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      items<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'USA'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'美国'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'CHN'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'中国'</span><span class="token punctuation">,</span> checked<span class="token punctuation">:</span> <span class="token string">'true'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'BRA'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'巴西'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'JPN'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'日本'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'ENG'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'英国'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'TUR'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token string">'法国'</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">radioChange</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'radio发生change事件，携带value值为：'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h2 id="组件"><a href="#组件" aria-hidden="true" class="header-anchor">#</a> 组件</h2> <h3 id="vue-组件"><a href="#vue-组件" aria-hidden="true" class="header-anchor">#</a> Vue 组件</h3> <p>组件是整个 Vue.js 中最复杂的部分，当然要支持 <a href="https://cn.vuejs.org/v2/guide/components.html" target="_blank" rel="noopener noreferrer">官方文档：组件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。</p> <p>**有且只能使用单文件组件（.vue 组件）的形式进行支持。**其他的诸如：动态组件，自定义 render，和<code>&lt;script type=&quot;text/x-template&quot;&gt;</code> 字符串模版等都不支持。原因很简单，因为我们要预编译出 wxml。</p> <p>如果未来小程序支持了动态增删改查 wxml 节点信息，那我们就能做到全支持。</p> <p>详细的不支持列表：</p> <ul><li>暂不支持在组件引用时，在组件上定义 click 等原生事件、v-show（可用 v-if 代替）和 class style 等样式属性(例：<code>&lt;card class=&quot;class-name&quot;&gt; &lt;/card&gt;</code> 样式是不会生效的)，因为编译到 wxml，小程序不会生成节点，建议写在内部顶级元素上。</li> <li>Slot（scoped 暂时还没做支持）</li> <li>动态组件</li> <li>异步组件</li> <li>inline-template</li> <li>X-Templates</li> <li>keep-alive</li> <li>transition</li> <li>class</li> <li>style</li></ul> <h3 id="小程序组件"><a href="#小程序组件" aria-hidden="true" class="header-anchor">#</a> 小程序组件</h3> <p>mpvue 可以支持小程序的原生组件，比如： <code>picker,map</code> 等，需要注意的是原生组件上的事件绑定，需要以 <code>vue</code> 的事件绑定语法来绑定，如 <code>bindchange=&quot;eventName&quot;</code> 事件，需要写成 <code>@change=&quot;eventName&quot;</code></p> <p>示例代码：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picker</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">start</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2015-09-01<span class="token punctuation">&quot;</span></span> <span class="token attr-name">end</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>2017-09-01<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bindDateChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>picker<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      当前选择: {{date}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picker</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="typescript支持"><a href="#typescript支持" aria-hidden="true" class="header-anchor">#</a> TypeScript支持</h2> <p>目前<code>mpvue-loader</code>是可以支持TypeScript选项的，配置方法<a href="/techthink/build/mpvue-loader/#typescript">在此</a>。具体Demo可以见<a href="https://github.com/WingGao/mpvue-ts-demo" target="_blank" rel="noopener noreferrer">mpvue-ts-demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="最佳实践"><a href="#最佳实践" aria-hidden="true" class="header-anchor">#</a> 最佳实践</h2> <p><strong>1. 精简 data 数据</strong></p> <p>冗余数据不要挂在 data 里，所有在 data/props/computed 中的数据，每次变更都会从微信小程序的 JSCore 进程，通过 setData 序列化成字符串后发送到 JSRender 进程。所以，如果你的数据量巨大的时候，会导致页面非常卡顿。</p> <p><strong>2. 优化长列表性能</strong></p> <p>一般情况下这种页面会有大量的数据，除了遵从上面的建议外还有额外的建议。</p> <ul><li>避免在 v-for 中嵌套子组件，这样可以优化大部分部分 setData 时的冗余数据。</li> <li>通过实践发现 wx:if 和 hidden 的优化肉眼不可见，所以或许可以试试直接通过样式 display 来展示和隐藏。</li> <li>如果列表过长，强烈建议产品思考更好的展示形态。比如只展示热门，多余的折叠等形式。</li></ul> <blockquote><p>注：我们对其进行了专门优化，最佳实践时和原生小程序代码的性能相差无几。</p></blockquote> <p><strong>3. 合理使用双向绑定</strong> <code>mpvue</code> 建议使用 <code>v-model.lazy</code> 绑定方式以优化性能，此外 <code>v-model</code> 在老基础库下输入框输入时可能存在光标重设的问题。</p> <p><strong>4. 谨慎选择直接使用小程序的 API</strong>
如果你有小程序和H5复用代码的需要，业务代码需要保持对 WEB <code>Vue.js</code> 的兼容性。此时我们不建议在代码中直接调用小程序API，更好的选择是通过桥接适配层屏蔽两端差异。</p> <h2 id="常见问题"><a href="#常见问题" aria-hidden="true" class="header-anchor">#</a> 常见问题</h2> <p><strong>1. 如何获取小程序在 page onLoad 时候传递的 options</strong></p> <p>在所有 页面 的组件内可以通过 <code>this.$root.$mp.query</code> 进行获取。</p> <p><strong>2. 如何获取小程序在 app onLaunch/onShow 时候传递的 options</strong></p> <p>在所有的组件内可以通过 <code>this.$root.$mp.appOptions</code> 进行获取。</p> <p><strong>3. 如何捕获 app 的 onError</strong></p> <p>由于 onError 并不是完整意义的生命周期，所以只提供一个捕获错误的方法，在 app 的根组件上添加名为 onError 的回调函数即可。如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
   <span class="token comment">// 只有 app 才会有 onLaunch 的生命周期</span>
   <span class="token function">onLaunch</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// ...</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>

   <span class="token comment">// 捕获 app error</span>
   <span class="token function">onError</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="mpvue-框架使用场景汇总"><a href="#mpvue-框架使用场景汇总" aria-hidden="true" class="header-anchor">#</a> mpvue 框架使用场景汇总</h2> <p><code>mpvue</code> 作为一个前端开发框架，提供了一整套解决方案。但开发者面临的实际情况可能更加复杂，我们整理了 <code>mpvue</code> 可能的使用场景，在这些场景下，我们为你提供了一些建议。</p> <p>首先，<code>mpvue</code> 小程序框架包含如下内容：</p> <ul><li>运行时JS SDK</li> <li>初始化模板项目（包含推荐的目录结构，webpack构建，代码检查配置等）</li> <li>项目构建所需的 npm 依赖（已经包含在项目模板中，无需手动引入）</li></ul> <h3 id="开发者可能会面对的四种典型场景"><a href="#开发者可能会面对的四种典型场景" aria-hidden="true" class="header-anchor">#</a> 开发者可能会面对的四种典型场景</h3> <ul><li>单独以 <code>mpvue</code> 框架构建小程序</li> <li><code>mpvue</code> 框架为主，同时使用其它框架（原生开发方式或wepy等）</li> <li>已经使用其它框架，引入 <code>mpvue</code> 做部分模块的开发</li> <li>只使用 <code>mpvue</code> 的 JS SDK，自定义构建策略</li></ul> <p>针对上述不同场景，<code>mpvue</code> 框架需要提供的方案和建议如下</p> <ul><li>单独以 <code>mpvue</code> 框架构建小程序
<ul><li><strong>推荐的方式，无需额外支持</strong>。通过框架提供的项目初始化工具初始化项目即可，已经包含完整的构建策略，代码组织方式等.</li></ul></li> <li><code>mpvue</code> 框架为主，同时使用其它框架（原生开发方式或wepy等）
<ul><li><strong>第三方框架和 <code>mpvue</code> 做分块构建</strong>。可能的方案是：不同框架各自的构建策略做好边界分离，最终通过单一入口聚合到一起。或者更简单的，拆成多个子项目，最终输出到同一目录，目标代码符合小程序规范即可。</li></ul></li> <li>已经使用其它框架，引入 <code>mpvue</code> 做部分模块的开发
<ul><li><strong><code>mpvue</code> 提供轻量的模块构建工具支持部分构建</strong>。对已有小程序项目接入 <code>mpvue</code> 来说，渐进的方式会是乐于接受的，可以先让一部分功能通过 <code>mpvue</code> 编写。此类场景，不再适合通过模板项目初始化项目结构，开发者可以参考模板项目中的代码编写方式，通过我们单独准备的构建工具，定制好构建任务即可。</li></ul></li> <li>只使用 <code>mpvue</code> 的 JS SDK，自定义构建策略
<ul><li><strong>需要开发者自定义 webpack 构建策略</strong>。 框架本身不建议开发者这么使用。但对于高阶的开发者，这是可能的方案。此时，开发者可以参考我们模板项目中的构建策略即可，我们目前只提供 webpack 构建方案。对于其它构建，我们暂不支持。</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/techthink/assets/js/app.7b5c53e5.js" defer></script><script src="/techthink/assets/js/2.7e3077ca.js" defer></script><script src="/techthink/assets/js/8.aad0e4ab.js" defer></script>
  </body>
</html>
